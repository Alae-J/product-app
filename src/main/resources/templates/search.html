<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Products</title>
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <script>
        // Ensure HTMX processes new content after AJAX updates
        document.body.addEventListener('htmx:afterSwap', function(evt) {
            if (evt.detail.target.id === 'product-table' || evt.detail.target.id === 'search-results') {
                htmx.process(evt.detail.target);
            }
        });
    </script>
</head>
<body class="container">
    <header style="text-align: center; margin-bottom: 3rem; padding-top: 2rem;">
        <h1 style="margin-bottom: 0.5rem; font-size: 2.5rem; font-weight: 700;">
            <i class="fas fa-search" style="color: var(--pico-primary);"></i> Search Products
        </h1>
        <p style="color: var(--pico-muted-color); font-size: 1.125rem; margin-bottom: 0;">
            Find products by typing in the search box
        </p>
    </header>
    
    <!-- Search interface -->
    <main style="margin-top: 2rem;">
        <section style="margin-bottom: 2rem;">
            <div class="grid" style="grid-template-columns: 1fr auto; gap: 1rem; align-items: end;">
                <label>
                    Search Products
                    <input type="search" placeholder="Start typing to search products..." hx-get="/products" hx-target="#product-table" hx-swap="innerHTML" hx-trigger="keyup changed delay:300ms, search" name="title" autocomplete="off">
                </label>
                <a href="/" class="secondary contrast">
                    <i class="fas fa-home"></i> Back to Home
                </a>
            </div>
        </section>
        
        <!-- edit modal -->
        <section id="edit-product-modal" style="display: none; margin-bottom: 2rem;">
            <!-- Edit product form will be loaded here -->
        </section>
        
        <section>
            <div id="search-results">
                <div id="product-table">
                    <div th:replace="~{fragments/products-table :: table}"></div>
                </div>
            </div>
        </section>
    </main>
</body>
</html>